# Kubean test case

| Function              | Case Name                                                                                             | Declaration              | Requirement ID | Status                 | Code Link                                                                                    | Test details                                                                                                                       |
|-----------------------|-------------------------------------------------------------------------------------------------------|--------------------------|---------------|------------------------|----------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------|
| Create basic cluster  | Support one node cluster: only one master node                                                        | master and worker in one node | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_functions_e2e/kubean_cluster_install_test.go)                  | [detail](./testcase_details/create_cluster.md#create-basic-cluster)                                                                |
|                       | Support CRI: containerd                                                                               |                          | C-013         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_functions_e2e/kubean_cluster_install_test.go)                  | [detail](./testcase_details/create_cluster.md#create-basic-cluster)                                                                |
|                       | Support CNI: calico                                                                                   |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_sonobouy_nightlye2e/kubean_cluster_sonobouy_test.go)           | [detail](./testcase_details/create_cluster.md#support-cni-calico)                                                                  |
|                       | Support calico tunnel mode: IPIP                                                                      |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_calico_nightlye2e/kubean_network_calico_test.go)               | [detail](./testcase_details/create_cluster.md#create-basic-cluster)                                                                |
|                       | Not overwirte hostname                                                                                |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_reset_e2e/kubean_cluster_reset_test.go)                        | [detail](./testcase_details/create_cluster.md#not-overwrite-hostname)                                                              |
|                       | Support disable cluster ca auto_renew                                                                 |                          | C-015         |                        |                                                                                              | [detail](./testcase_details/create_cluster.md#create-basic-cluster)                                                                |
|                       | Ssh authorization: user name and password                                                             |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_sonobouy_nightlye2e/kubean_cluster_sonobouy_test.go)           | [detail](./testcase_details/create_cluster.md#create-basic-cluster)                                                                |
| Create cluster:extend | Create cluster topology: 1 master and 1 worker                                                        |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_sonobouy_nightlye2e/kubean_cluster_sonobouy_test.go)           | [detail](./testcase_details/create_cluster.md#create-cluster-with-one-master-and-one-worker)                                       |
|                       | Create cluster topology: 3 master and 2 worker                                                        |                          | C-012         |                        |                                                                                              | [detail](./testcase_details/create_cluster.md#create-cluster-topology-3-master-and-2-worker)                                       |
|                       | Support k8s: 1.23                                                                                     |                          | C-012         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_sonobouy_nightlye2e/kubean_cluster_sonobouy_test.go)           | [detail](./testcase_details/create_cluster.md#support-k8s-1230)                                                                    |
|                       | Support k8s: 1.24                                                                                     |                          | C-012         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_sonobouy_nightlye2e/kubean_cluster_sonobouy_test.go)           | [detail](./testcase_details/create_cluster.md#support-k8s-124)                                                                     |
|                       | Support k8s: 1.25                                                                                     |                          | C-012         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_sonobouy_nightlye2e/kubean_cluster_sonobouy_test.go)           |                                                                                                                                    |
|                       | Support CRI: docker                                                                                   |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_sonobouy_nightlye2e/kubean_cluster_sonobouy_test.go)           | [detail](./testcase_details/create_cluster.md#support-cri-docker)                                                                  |
|                       | SSH authorization: private key                                                                        |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_add_remove_worker_nightlye2e/kubean_add_remove_worker_test.go) | [detail](./testcase_details/create_cluster.md#ssh-authorization-private-key)                                                       |
|                       | Support single stack calico tunnel mode: IPIP_Always                                                  |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_calico_nightlye2e/kubean_network_calico_test.go)               | [detail](./testcase_details/create_cluster.md#create-cluster-with-calico-vxlan_always-tuning-mode)                                 |
|                       | Support single stack calico tunnel mode: IPIP_CrossSubnet                                             |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_calico_nightlye2e/kubean_network_calico_test.go)               | [detail](./testcase_details/create_cluster.md#create-cluster-with-calico-ipip_crosssubnet-tuning-mode)                             |
|                       | Support single stack calico tunnel mode: Vxlan_Always                                                 |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_calico_nightlye2e/kubean_network_calico_test.go)               | [detail](./testcase_details/create_cluster.md#create-cluster-with-calico-vxlan_always-tuning-mode)                                 |
|                       | Support single stack calico tunnel mode: Vxlan_CrossSubnet                                            |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_calico_nightlye2e/kubean_network_calico_test.go)               | [detail](./testcase_details/create_cluster.md#create-cluster-with-calico-vxlan_crosssubnet-tuning-mode)                            |
|                       | Support single stack calico: kube_pods_subnet                                                         | kube_pods_subnet         | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_functions_e2e/kubean_cluster_install_test.go)                  | [detail](./testcase_details/create_cluster.md#support-kube_pods_subnet)                                                            |
|                       | Support single stack calico: kube_service_addresses                                                   | kube_service_addresses   | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_functions_e2e/kubean_cluster_install_test.go)                  | [detail](./testcase_details/create_cluster.md#support-kube_service_addresses)                                                      |
|                       | Support dual stack calico tunnel mode: IPIP_Always + Vxlan_CrossSubnet                                |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_calico_dualstack_e2e/kubean_calico_dual_stack_test.go)         | [detail](./testcase_details/create_cluster.md#create-cluster-support--calico-dual-stack-v4-ipip_alwaysv4_vxlan_crosssubnetv6)      |
|                       | Support dual stack calico tunnel mode: IPIP_CrossSubnet +  Vxlan_CrossSubnet                          |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_calico_dualstack_e2e/kubean_calico_dual_stack_test.go)         | [detail](./testcase_details/create_cluster.md#create-cluster-support--calico-dual-stack-v4-ipip_crosssubnetv4_vxlan_crosssubnetv6) |
|                       | Support dual stack calico tunnel mode: Vxlan_Always + Vxlan_Always                                    |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_calico_dualstack_e2e/kubean_calico_dual_stack_test.go)         | [detail](./testcase_details/create_cluster.md#create-cluster-support--calico-dual-stack-v4-vxlan_alwaysv4_vxlan_alwaysv6)          |
|                       | Support dual stack calico tunnel mode: Vxlan_CrossSubnet + Vxlan_Always                               |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_calico_dualstack_e2e/kubean_calico_dual_stack_test.go)         | [detail](./testcase_details/create_cluster.md#create-cluster-support--calico-dual-stack-v4-vxlan_crosssubnetv4_vxlan_alwaysv6)     |
|                       | Support dual stack calico: kube_pods_subnet of ipv4 and ipv6                                          |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support dual stack calico: kube_service_addresses of ipv4 and ipv6                                    |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support create cilium clusters                                                                        |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_cilium_cluster_e2e/create_cilium_cluster_test.go)              | [detail](./testcase_details/create_cluster.md#create-cilium-cluster)                                                               |
|                       | Support CNI: none                                                                                     | onlu install only cni dependency | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Cluster node on different sub net                                                                     |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support CRI: runc/kata/gvisor                                                                         |                          | C-042         |                        |                                                                                              |                                                                                                                                    |
|                       | Support cilium: kube_pods_subnet                                                                      |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_cilium_cluster_e2e/create_cilium_cluster_test.go)              | [detail](./testcase_details/create_cluster.md#create-cilium-cluster)                                                               |
|                       | Support cilium: kube_service_addresses                                                                |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_cilium_cluster_e2e/create_cilium_cluster_test.go)              | [detail](./testcase_details/create_cluster.md#create-cilium-cluster)                                                               |
|                       | Support cluster ca auto_renew                                                                         | auto_renew_certificates:true | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support overwrite hostname                                                                            | override_system_hostname=true | C-001         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_functions_e2e/kubean_cluster_install_test.go)                  | [detail](./testcase_details/create_cluster.md#support-overwrite-hostname)                                                          |
|                       | Support install k8s on Readhat8 node: online                                                          |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../..test/kubean_os_compatibility_e2e/kubean_os_compatibility_test.go)           | [detail](./testcase_details/create_cluster.md#support-readhat8-os)                                                                 |
|                       | Support install k8s on Readhat7 node: online                                                          |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../..test/kubean_os_compatibility_e2e/kubean_os_compatibility_test.go)           | [detail](./testcase_details/create_cluster.md#support-readhat7-os)                                                                 |
|                       | Support install k8s on Centos8 node: online                                                           |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../..test/kubean_os_compatibility_e2e/kubean_os_compatibility_test.go)           | [detail](./testcase_details/create_cluster.md#support-centos8-os)                                                                  |
|                       | Support install k8s on KylinV10SP2 node: offline                                                      |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../..test/kubean_os_compatibility_e2e/kubean_os_compatibility_test.go)           |                                                                                                                                    |
|                       | Support install k8s on Readhat8 node: offline                                                         |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../..test/kubean_os_compatibility_e2e/kubean_os_compatibility_test.go)           | [detail](./testcase_details/create_cluster.md#support-readhat8-os)                                                                 |
|                       | Support install k8s on Readhat7 node: offline                                                         |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../..test/kubean_os_compatibility_e2e/kubean_os_compatibility_test.go)           | [detail](./testcase_details/create_cluster.md#support-readhat7-os)                                                                 |
|                       | Support install k8s on Centos7 node: offline                                                          |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../..test/kubean_os_compatibility_e2e/kubean_os_compatibility_test.go)           | [detail](./testcase_details/create_cluster.md#support-readhat7-os)                                                                 |
|                       | Support create cluster on public clouds                                                               |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support create cluster on physical machine                                                            |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support kube-vip                                                                                      |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support ipvs mode                                                                                     |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support iptable mode                                                                                  |                          | C-001         | <ul><li>[x] </li></ul> | [Code Link](../..test/kubean_functions_e2e/kubean_cluster_install_test.go)                   | [detail](./testcase_details/create_cluster.md#support-iptables-mode)                                                               |
|                       | Support non root user install                                                                         |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support local DNS server                                                                              |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support local NTP server                                                                              |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support set kubelet_max_pods                                                                          |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support set kubernetes_audit                                                                          |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Support local insecure registry                                                                       |                          | C-001         |                        |                                                                                              |                                                                                                                                    |
|                       | Create cluster with same node name, should be fail                                                    |                          | C-001         |                        |                                                                                              | [detail](./testcase_details/create_cluster.md#create-cluster-set-all-the-nodes-with-same-name)                                     |
|                       | Support kubean install not in kubean-system                                                           |                          |               |                        |                                                                                              |                                                                                                                                    |
| Reset                 | Cluster reset                                                                                         |                          |               | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_reset_e2e/kubean_cluster_reset_test.go)                        | [detail](./testcase_details/cluster_operation.md#cluster-reset)                                                                    |
|                       | Retry 0 times when job fail                                                                           | backoffLimit=0           |               | <ul><li>[x] </li></ul> | [Code Link](../../test/kubeanOps_functions_nightlye2e/kubean_bol0_test.go)                   | [detail](./testcase_details/cluster_operation.md#retry-0-times-when-job-fail)                                                      |
|                       | Retry 1 times when job fail                                                                           | backoffLimit=1           |               |<ul><li>[x] </li></ul>  | [Code Link](../../test/kubeanOps_functions_nightlye2e/kubean_bol1_test.go)                   |                                                                                                                                    |
|                       | Retry 2 times when job fail                                                                           | backoffLimit=2           |               |<ul><li>[x] </li></ul>  | [Code Link](../../test/kubeanOps_functions_nightlye2e/kubean_bol2_test.go)                   |                                                                                                                                    |
| Cluster Function      | Posthook  the kubeconfig  to kubean                                                                   |                          |               |<ul><li>[x] </li></ul>  | [Code Link](../../test/kubean_sonobouy_nightlye2e/kubean_cluster_sonobouy_test.go)           | [detail](./testcase_details/kubean_func.md#posthook-cluster-kubeconfig)                                                            |
|                       | Limit concurrent operations of the cluster                                                            |                          |               |<ul><li>[x] </li></ul>  | [Code Link](../../test/kubeanOps_functions_nightlye2e/kubeanOps_test.go)                     |                                                                                                                                    |                                                                        |                                                                                                 |
|                       | Delete the backup resources reverse order                                                             | default reserve 5 copies |               |<ul><li>[x] </li></ul>  | [Code Link](../../test/kubeanOps_functions_nightlye2e/kubeanOps_test.go)                     |                                                                                                                                    |
|                       | Anti-modification flag can be set when backup resource be modified                                    |                          |               |                        |                                                                                              |                                                                                                                                    |
| Add/Remove node       | Add master online                                                                                     |                          | C-004         |                        |                                                                                              |                                                                                                                                    |
|                       | Add worker online                                                                                     |                          | C-004         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_add_remove_worker_nightlye2e/kubean_add_remove_worker_test.go) | [detail](./testcase_details/cluster_operation.md#add-worker)                                                                       |
|                       | Remove worker online                                                                                  |                          | C-004         |<ul><li>[x] </li></ul>  | [Code Link](../../test/kubean_add_remove_worker_nightlye2e/kubean_add_remove_worker_test.go) | [detail](./testcase_details/cluster_operation.md#remove-online-worker)                                                             |
|                       | Add worker offline                                                                                    |                          | C-004         |                        |                                                                                              | [detail](./testcase_details/cluster_operation.md#remove-offline-worker)                                                            |
|                       | Remove worker offline                                                                                 |                          | C-004         |                        |                                                                                              | [detail](./testcase_details/cluster_operation.md#remove-offline-worker)                                                            |
|                       | Remove online/offline master                                                                          |                          | C-004         |                        |                                                                                              |                                                                                                                                    |
|                       | Online master down in remove procedure                                                                |                          | C-004         |                        |                                                                                              |                                                                                                                                    |
|                       | Online worker down in remove procedure                                                                |                          | C-004         |                        |                                                                                              | [detail](./testcase_details/cluster_operation.md#online-worker-down-in-remove-procedure)                                           |
|                       | Readd master node to cluster                                                                          |                          | C-015         |                        |                                                                                              |                                                                                                                                    |
|                       | Readd a worker to cluster                                                                             |                          | C-015         |                        |                                                                                              | [detail](./testcase_details/cluster_operation.md#readd-a-worker-to-cluster)                                                        |
|                       | Manual update ca                                                                                      | kubeadmin renew          | C-015         |                        |                                                                                              |                                                                                                                                    |
| Hot upgrade           | Hot upgrade k8s Z version: online                                                                     |                          | C-003         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_sonobouy_nightlye2e/kubean_cluster_sonobouy_test.go)           |
|                       | Hot upgrade k8s Y version: online                                                                     |                          | C-003         | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_sonobouy_nightlye2e/kubean_cluster_sonobouy_test.go)           | [detail](./testcase_details/cluster_operation.md#hot-upgrade-k8s-y-version-online)                                                 |
|                       | Hot upgrade k8s Z  version: offline                                                                   |                          | C-003         |                        |                                                                                              |                                                                                                                                    |
|                       | Hot upgrade k8s Y  version: offline                                                                   |                          | C-003         |                        |                                                                                              |                                                                                                                                    |
|                       | Hot upgrade CNI                                                                                       | To be determined         | C-003         |                        |                                                                                              |                                                                                                                                    |
|                       | Hot upgrade CRI-containerd online/offline                                                             |                          | C-003         |                        |                                                                                              |                                                                                                                                    |
|                       | Hot upgrade CRI-docker online/offline                                                                 |                          | C-003         |                        |                                                                                              |                                                                                                                                    |
|                       | Use low kubean install a low version k8s, then upgrade kubean, and upgrande kubean version to highest |                          | C-003         |                        |                                                                                              |                                                                                                                                    |
| High availability     | Hight availability of not firt master : Node crash                                                    |                          | L-019         |                        |                                                                                              |                                                                                                                                    |
|                       | Hight availability of not firt master: CPU Insufficient                                               |                          | L-019         |                        |                                                                                              |                                                                                                                                    |
|                       | Hight availability of not firt master: Disk Insufficient                                              |                          | L-019         |                        |                                                                                              |                                                                                                                                    |
|                       | Hight availability of not firt master: Memory Insufficient                                            |                          | L-019         |                        |                                                                                              |                                                                                                                                    |
|                       | Hight availability of not firt master: Network unstable                                               |                          | L-019         |                        |                                                                                              |                                                                                                                                    |
|                       | Hight availability of leader etcd                                                                     |                          | L-019         |                        |                                                                                              |                                                                                                                                    |
|                       | Hight availability of follower etcd                                                                   |                          | L-019         |                        |                                                                                              |                                                                                                                                    |
|                       | Hight availability of worker: Node crash                                                              |                          | L-018         |                        |                                                                                              |                                                                                                                                    |
|                       | Hight availability of firt master                                                                     | To be determind          | L-019         |                        |                                                                                              |                                                                                                                                    |
| Others                | Hardware accelerator                                                                                  | To be determind          |               |                        |                                                                                              |                                                                                                                                    |
|                       | Ntp func when create cluster                                                                          |                          | C-001         |                        |                                                                                              | [detail](./testcase_details/create_cluster.md#ntp-func-when-create-cluster)                                                        |
|                       | Ntp func while cluster in use                                                                         |                          | C-001         |                        |                                                                                              | [detail](./testcase_details/cluster_operation.md#readd-a-worker-to-cluster)                                                        |
|                       | Install kubean on not kubean-system namespace                                                         |                          |               |                        |                                                                                              |                                                                                                                                    |
|                       | k8s version compatibility test, from 1.20 to 1.26                                                     |                          |               | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_k8s_compatibility_e2e/kubean_k8s_compatibility_test.go)        |                                                                                                                                    |
|                       | Set up multiple kubean operator replicas                                                              | set replicas to 3        |               | <ul><li>[x] </li></ul> | [Code Link](../../test/kubean_cilium_cluster_e2e/create_cilium_cluster_test.go)              | [detail](./testcase_details/kubean_func.md#set-multi-kubean-operator)                                                              |
